# Resources
[Resources](https://github.com/RoStrap/Resources/blob/master/Resources.module.lua) is the core resource-loader for [RoStrap](https://www.roblox.com/library/725884332/RoStrap). It is designed to simplify the loading of libraries and unify the networking of resources between the client and server.

## Set-up
[Resources](https://github.com/RoStrap/Resources/blob/master/Resources.module.lua) is automatically installed when you setup using the plug-in, which can installed after clicking the logo below:

[![](https://avatars1.githubusercontent.com/u/22812966?v=4&s=100)](https://www.roblox.com/library/725884332/RoStrap)

After installing, you should have a [Folder](http://wiki.roblox.com/index.php?title=API:Class/Folder) called `Repository` in [ServerStorage](http://wiki.roblox.com/index.php?title=API:Class/ServerStorage) or [ServerScriptService](http://wiki.roblox.com/index.php?title=API:Class/ServerScriptService). This is where all of your [ModuleScripts](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript), which are referred to as "Libraries", reside.

## Initialization
To start using the module, simply `require` it.
```lua
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Resources = require(ReplicatedStorage:WaitForChild("Resources"))
```
#### Behavior
Upon requiring [Resources](https://github.com/RoStrap/Resources/blob/master/Resources.module.lua) on the server for the first time, it will move [ModuleScripts](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript) from your `Repository` into [ReplicatedStorage](http://wiki.roblox.com/index.php?title=API:Class/ReplicatedStorage) so the client can access your installed libraries. These will be accessible via the LoadLibrary method below, which is basically a require-by-string method which ignores heiarchy. The server can access any Library, while the client can't access the server libraries but can access the replicated libraries.

Libraries with "Server" in either their name or in the name of an ancestor folder will not be replicated to clients, and will only be accessible to the server (in [ServerStorage](http://wiki.roblox.com/index.php?title=API:Class/ServerStorage)).

![](https://image.prntscr.com/image/ZonjgCDFQLabru0xbMBUNQ.png)

## Functionality and API
The main purpose of `Resources` is to retrieve objects for use on both the client and server, both by the same functions. This means Libraries can run the same code on both the client and server and be guaranteed the resource will always be properly obtained.

All functions in `Resources` should be called using method syntax, however the following is supported in addition to method syntax:
```lua
local require = Resources.LoadLibrary
local Tween = require("Tween")
```

#### LoadLibrary
```lua
Variant LoadLibrary (string LibraryName)
-- require-by-string function
-- Any Library installed in your Repository can be required via LoadLibrary("LibraryName")
```
A Library is constituted of a [ModuleScript](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript) (in ServerStorage.Repository) and its descendants.

![](https://image.prntscr.com/image/hLnGGl3JST_vAZYnYadrGg.png)

To load the `Tween` Library, we would do the following:
```lua
local Tween = Resources:LoadLibrary("Tween")
```
Many Libraries developed outside the `Resources` bootstrapper system rely on using the built-in `require` function on child ModuleScripts, which is why descendants of Libraries are left unmoved. The example below demonstrates how heirarchy within the repository is ignored during replication, except under ModuleScripts (CustomFont by EgoMoose gets to keep its descendants).

![](https://image.prntscr.com/image/ZonjgCDFQLabru0xbMBUNQ.png)

#### Get Functions
The rest of the functions within `Resources` are procedurally generated, in the form of `GetCLASSNAME` with string parameter `Name`. These functions return an instance under `ReplicatedStorage.Resources.CLASSNAMES` called `Name`. On the server, missing instances will be generated. On the client, the function will yield until the missing instances are generated by the server.
```lua
local Chatted = Resources:GetRemoteEvent("Chatted")
local ClientLoaded = Resources:GetRemoteFunction("ClientLoaded")
```

Any instance type is compatible with `Resources`:

```lua
-- Not sure why you would need to, but this retrieves a TextLabel
-- called "Superman" inside ReplicatedStorage.Resources.TextLabels
local Superman = Resources:GetTextLabel("Superman")
```
In fact, `Resources` can also manage instance types that aren't creatable by `Instance.new`. They must however, be preinstalled into `Replicated.Resources`. This basically allows you to do things like the following:
```lua
local Falchion = Resources:GetSword("Falchion")
-- As long as this exists as Resources.Swords.Falchion,
-- it will be retrieved

-- The function generator will remove "Get" from "GetSword"
-- It will then add "s" to "Sword" and thus expect the Folder
-- to be named "Swords".
-- Library (and Accessory, etc) will be in Folder "Librar" .. ies"
```

#### GetLocal Functions
If you want to access local storage (not replicated across the client-server model), you can add `Local` before `CLASSNAME` to access it. On the server, local storage is located in [ServerStorage](http://wiki.roblox.com/index.php?title=API:Class/ServerStorage). On the client, "local storage" is located in [LocalPlayer](http://wiki.roblox.com/index.php?title=API:Class/Players/LocalPlayer). Everything Resources stores goes into folders named `Resources`. Any computer (client or server) can instantiate instances on local storage.

|LocalStorage|**Location**|
|:-----:|:----:|
|Server|ServerStorage.Resources|
|Client|Players.LocalPlayer.Resources|

```lua
local Attacking = Resources:GetLocalBindableEvent("Attacking")
-- Finds LOCALSTORAGE.Resources.BindableEvents.Attacking,
-- where LOCALSTORAGE is LocalPlayer on the client and ServerStorage on the Server,
-- where "Resources" and "BindableEvents" are each Folder Objects,
-- and Attacking is a BindableEvent Object

-- Each instance not present will always be generated (on whichever computer it runs)
```
##### GetLocalTable
The `GetLocalTable` function doesn't search any roblox objects, but rather returns a (non-replicated) table hashed within `Resources` under the `name` parameter. This is just a convienent way to not have Libraries that just do `return {}`
```lua
local Shared = Resources:GetLocalTable("Shared") -- returns a table

-- In another script
local Shared = Resources:GetLocalTable("Shared") -- same table (if on the same computer)
local Shared2 = Resources:GetLocalTable("Shared2") -- different table
```
#### GetFolder and GetLocalFolder
These functions will not return Folders within `Resources.Folders`, but rather `Resources`.

If you wanted a list of all Libraries or BindableEvents, you could do the following:
```lua
-- This is still a Get function, so it will WaitForChild on the client, and generate on the server if non-existant
local Libraries = Resources:GetFolder("Libraries"):GetChildren()
for i = 1, #Libraries do
  print(Libraries[i]:GetFullName())
end
```
![](https://image.prntscr.com/image/ZonjgCDFQLabru0xbMBUNQ.png)

Keep in mind you can use `GetLibrary` if you would like to get a Library without requiring it. However, `GetLibrary` will error on the server if it doesn't find a library, and yield indefinitely on the client. `GetFolder` can be used return a folder object upon which to call `FindFirstChild` if one wants to check whether a library already exists.

```lua
local TweenIsInstalled = Resources:GetFolder("Libraries"):FindFirstChild("Tween")

if TweenIsInstalled then
  print("Tween is installed!")
end
```

`GetLocalFolder` returns `LOCALSTORAGE.Resources.FOLDER_NAME` where `FOLDER_NAME` is the parameter passed. As expected, `GetLocalFolder` will always create folders that do not exist.

## Tags
Whether Libraries are replicated to the client or stay on the server is determined by the tags that individual libraries have at run-time. These tags are automatically assigned by the plugin, but you can modify them too. [Here is a plug-in that allows you to add and remove Tags](https://www.roblox.com/library/948084095/TagPlugin).

The built-in Tags are `ServerLibraries` and `ReplicatedLibraries`. These determine whether a Library is put in the Server-accessible repository or the Client-accessible repository, respectively. You don't have to worry about the actual location of the Library objects, as you need only interact with the actual objects via the methods prescribed below. Beginners should skip the next two paragraphs.

Resources has built-in tag extendability, so the developer can assign tags to Libraries and Resources will run a user-defined function at run-time. Simply put a [Folder](http://wiki.roblox.com/index.php?title=API:Class/Folder) called "LibraryTags" inside of [Resources](https://github.com/RoStrap/Resources/blob/master/Resources.module.lua) and insert a [ModuleScript](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript) inside with the name of the tag whose behavior you wish to define. The module should return a function with parameters `(table Modules, number ModuleCount, table Libraries)` where `Modules` is a table of objects with the assigned tag, `MoudleCount` is `#Modules` (we want you to use a simple for loop) and `Libraries` is the internal table filled with all of the Libraries accessible to `Resources:LoadLibrary("LibraryName")`.

There are 3 additional tags automatically supported by the plugin; the first being `ServerStuff`. At run-time, `ServerStuff` moves to [Folder](http://wiki.roblox.com/index.php?title=API:Class/Folder) [ServerScriptService](http://wiki.roblox.com/index.php?title=API:Class/ServerScriptService).Server (it will be generated if necessary). The other tags are `StarterPlayerScripts` and `StarterPlayerCharacter`, which are moved to their obvious proper location at run-time. If you give any of these 3 tags to any Library within your Repository the plugin will automatically setup the necessary "LibraryTags" [Folder](http://wiki.roblox.com/index.php?title=API:Class/Folder) with the defined behavior within a ModuleScript.

### Ideas
#### Map Changer
Try using Resources to manage other things like Maps for a game! Make a Folder named "Maps" inside `ReplicatedStorage.Resources` and it can then be accessed!
```lua
local Resources = require(ReplicatedStorage:WaitForChild("Resources"))
local Hometown = Resources:GetMap("Hometown v2")
Hometown.Parent = workspace
```
#### Gun system
```lua
-- Server-side
local GunThePlayerJustBought = Resources:GetLocalGun("Ak47")
-- Finds `ServerStorage.Resources.Guns.Ak47`
-- Make sure the above exists if you want to use it for things that are not valid Roblox Classes
-- Otherwise, Resources will error trying to do Instance.new("Gun")

GunThePlayerJustBought:Clone().Parent = PlayerBackpackThatBoughtIt
```

## Contact
If you have any questions, concerns, or feature requests, feel free to [message Validark on roblox](https://www.roblox.com/messages/compose?recipientId=2966752). There is also a dedicated issues tab at the top of this page, should you feel inclined to use that. Please send all hatemail, noodles, or unsavory requests to [devSparkle](https://www.roblox.com/messages/compose?recipientId=1631699).
